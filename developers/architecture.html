<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RelayKeys Docs</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="manifest" href="/RelayKeys/site.webmanifest">
    <link rel="mask-icon" href="/RelayKeys/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" type="image/x-icon" href="/RelayKeys/favicon.ico">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="180x180" href="/RelayKeys/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/RelayKeys/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/RelayKeys/favicon-16x16.png">
    <meta name="description" content="Emulate a Keyboard and Mouse with a computer">
    <meta name="application-name" content="RelayKeys Docs">
    <meta name="theme-color" content="#263238">
    <meta name="apple-mobile-web-app-title" content="Directus Docs">
    <meta name="msapplication-TileColor" content="#263238">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <link rel="preload" href="/RelayKeys/assets/css/0.styles.99636053.css" as="style"><link rel="preload" href="/RelayKeys/assets/js/app.4e4d4d42.js" as="script"><link rel="preload" href="/RelayKeys/assets/js/2.6ef3ed40.js" as="script"><link rel="preload" href="/RelayKeys/assets/js/7.783ad4b0.js" as="script"><link rel="prefetch" href="/RelayKeys/assets/js/10.d9476cfd.js"><link rel="prefetch" href="/RelayKeys/assets/js/11.e8ba65c0.js"><link rel="prefetch" href="/RelayKeys/assets/js/12.97121080.js"><link rel="prefetch" href="/RelayKeys/assets/js/13.655ceeaa.js"><link rel="prefetch" href="/RelayKeys/assets/js/14.bda95b96.js"><link rel="prefetch" href="/RelayKeys/assets/js/15.c5c173b1.js"><link rel="prefetch" href="/RelayKeys/assets/js/16.ee60ec9a.js"><link rel="prefetch" href="/RelayKeys/assets/js/17.3721444e.js"><link rel="prefetch" href="/RelayKeys/assets/js/18.d8536204.js"><link rel="prefetch" href="/RelayKeys/assets/js/19.26581eba.js"><link rel="prefetch" href="/RelayKeys/assets/js/20.f964d2ff.js"><link rel="prefetch" href="/RelayKeys/assets/js/21.6c542ca7.js"><link rel="prefetch" href="/RelayKeys/assets/js/22.73e398e9.js"><link rel="prefetch" href="/RelayKeys/assets/js/23.151a14af.js"><link rel="prefetch" href="/RelayKeys/assets/js/24.07cc3d44.js"><link rel="prefetch" href="/RelayKeys/assets/js/25.35e9ddda.js"><link rel="prefetch" href="/RelayKeys/assets/js/26.dc4ae375.js"><link rel="prefetch" href="/RelayKeys/assets/js/3.9b8c371e.js"><link rel="prefetch" href="/RelayKeys/assets/js/4.a6107842.js"><link rel="prefetch" href="/RelayKeys/assets/js/5.8f4b491f.js"><link rel="prefetch" href="/RelayKeys/assets/js/6.56a1ded7.js"><link rel="prefetch" href="/RelayKeys/assets/js/8.799cf335.js"><link rel="prefetch" href="/RelayKeys/assets/js/9.7ee384ca.js">
    <link rel="stylesheet" href="/RelayKeys/assets/css/0.styles.99636053.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/RelayKeys/" class="home-link router-link-active"><img src="/RelayKeys/img/AceLogo.png" alt="RelayKeys Docs" class="logo"> <span class="site-name can-hide">RelayKeys Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://acecentre.org.uk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AceCentre
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/acecentre/relaykeys" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://acecentre.org.uk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AceCentre
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/acecentre/relaykeys" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>‚å®Ô∏è Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/RelayKeys/getting-started/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/RelayKeys/getting-started/installation.html" class="sidebar-link">Installation</a></li><li><a href="/RelayKeys/getting-started/supporting-relaykeys.html" class="sidebar-link">Supporting RelayKeys</a></li><li><a href="/RelayKeys/getting-started/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>üìñ AAC Integration Guides</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>üöÄ Command Line Interface (CLI) Details</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ü•º Serial Bus API details</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>‚ö°Ô∏è Development Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/RelayKeys/developers/architecture.html" aria-current="page" class="active sidebar-link">Architecture and Getting started</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/RelayKeys/developers/architecture.html#anatomy-of-the-files" class="sidebar-link">Anatomy of the files</a></li><li class="sidebar-sub-header"><a href="/RelayKeys/developers/architecture.html#steps-to-run-relaykeys-non-installer-method" class="sidebar-link">Steps to run RelayKeys (non-installer method)</a></li></ul></li><li><a href="/RelayKeys/developers/supported-boards.html" class="sidebar-link">Supported Boards and Build Instructions</a></li><li><a href="/RelayKeys/developers/reference.html" class="sidebar-link">RPC Daemon Details</a></li><li><a href="/RelayKeys/developers/relaykeys-cfg.html" class="sidebar-link">Config file details</a></li><li><a href="/RelayKeys/developers/other-projects.html" class="sidebar-link">Other Projects</a></li><li><a href="/RelayKeys/developers/credits.html" class="sidebar-link">Credits</a></li><li><a href="/RelayKeys/developers/documentation.html" class="sidebar-link">Documentation notes</a></li><li><a href="/RelayKeys/developers/contributing.html" class="sidebar-link">Contributing</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="architecture-of-relaykeys"><a href="#architecture-of-relaykeys" class="header-anchor">#</a> Architecture of RelayKeys</h1> <p><img src="/RelayKeys/assets/img/sketch-architecture.f196b0d5.jpeg" alt="RelayKeys Sketch"></p> <p>RelayKeys is a mixture of a Open Hardware board that communicates in Bluetooth LE (4), a RPC server (2) to communicate over serial to the board (3) and then RPC clients (1) such as the relaykeys-cli and relaykeys-qt applications. The Arduino based board is currently a <strong>Adafruit nrf52840 express</strong>. We use this board as it has very nice low level <strong>AT</strong> Commands we can talk to emulate <strong>all</strong> keyboard keys and their modifiers - as well as functions found on other common BT LE devices such as media keys. In short, <strong>Adafruit have done the hardwork for us and its reliable</strong>.</p> <h2 id="anatomy-of-the-files"><a href="#anatomy-of-the-files" class="header-anchor">#</a> Anatomy of the files</h2> <ul><li><code>arduino/</code> - firmware for the arduino board</li> <li><code>docs/</code>  - VuePress docs for http://acecentre.github.io/relayKeys/. Build Script is <strong>docs-deploy.sh</strong></li> <li><code>resources/</code> - Helper files for development (e.g. <code>demoSerial.py</code> which pretends to be an arduino board connected, viewComPorts which outputs the connected com ports), AAC software pagesets and all-keys.txt which is a output of all the keys supported by RelayKeys. Also note the development files - <code>relaykeys-pygame</code> and <code>relaykeys.py</code> - which are stripped down versions of the whole project. Useful for debugging and testing things without the daemon server. Just move <code>relaykeys.py</code> into the root directory to get it to work.</li> <li><code>blehid.py</code> - Library/Import file used by relaykeysd. Includes the function that writes the AT command to the serial port, init the serial port, and sends keyboard/mouse codes.</li> <li><code>build.py</code>, <code>buildinstaller.nsi</code> - Build files to turn this project into a installer. Run <code>python build.py</code> to trigger the build.</li> <li><code>docs-deploy.sh</code> - deploys the documentation to the github pages site.</li> <li><code>relaykeys-cli.py</code> - This is the command line interface version of relaykeys. Conencts to the daemon server.</li> <li><code>relaykeys-example.cfg</code> - The default config file. Note this gets copied on install to the right location and is used as the standard config. Note commented out baud and dev lines. Dev fixes the <code>COM</code> port if the com port finding code doesn't work</li> <li><code>relaykeys-qt.py</code> - The GUI version of our relakeys testing app.</li> <li><code>relaykeys.spec.ini</code> - Used for the NSIS build (i.e. <code>buildinstaller.nsi</code>)</li> <li><code>relaykeysclient.py</code> - The main library file used by -cli and -qt versions. Connects to the server.</li> <li><code>relaykeysd-service-restart.bat</code>, <code>relaykeysd-service.py</code> - The Windows service applcation</li> <li><code>relaykeysd.py</code> - The daemon. This is what is run in the background - and controlled by the service. If you want to test RelayKeys - run this file first - and leave it running. e.g. <code>python relakyeysd.py &amp;&amp;</code>. Note the command line flags in the header.</li></ul> <h2 id="steps-to-run-relaykeys-non-installer-method"><a href="#steps-to-run-relaykeys-non-installer-method" class="header-anchor">#</a> Steps to run RelayKeys (non-installer method)</h2> <p><em>Prerequisites</em></p> <ul><li><a href="https://www.python.org/downloads/windows/" target="_blank" rel="noopener noreferrer">Install Python 3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Have access to a nrf52840 arduino board. e.g. the Adafruit nrf52840 express</li></ul> <ol><li>Grab a nrf52840 board and load the arduino code onto it. Plug it in a usb slot on your computer</li> <li>Check your arduino is working as expected. Find and make a note of the COM port it is (<a href="https://www.sevenforums.com/attachments/hardware-devices/263068d1486601972t-com-port-missing-device-manager-com-port-pic.jpg" target="_blank" rel="noopener noreferrer">found in the device manager<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li> <li>Download the code to a sensible location - e.g. <code>git clone https://github.com/AceCentre/RelayKeys.git</code></li> <li>Copy  the <code>relaykeys-example.cfg</code> file e.g. <code>copy relaykeys-example.cfg relaykeys.cfg</code></li> <li>Install requirements e.g. <code>pip install -r requirements.txt</code></li> <li>Run the Daemon code. <code>python relaykeysd.py</code></li> <li>Pair your relaykeys arduino with a PC/Mac/iOS/Android device and open a text file</li> <li>Test it out with the cli file e.g. <code>python relaykeys-cli.py type:Hello</code></li></ol> <p>You should, if everything is working as expected, see it type on the second device. If not have a look at the log files.</p> <p>One problem may be that the daemon cant find the COM port. You can fix this by fixing the com port you found in step 2 and putting it in the config file. e.g. add <code>dev=COM6</code> if the com port is 6. More information can be found <a href="/RelayKeys/developers/relaykeys-cfg.html#dev-defining-your-port-of-the-relaykeys-hardware">here</a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/acecentre/relaykeys/edit/master/docs/developers/architecture.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/28/2020, 9:59:59 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/RelayKeys/serial-api/reference.html" class="prev">
        Serial Commands
      </a></span> <span class="next"><a href="/RelayKeys/developers/supported-boards.html">
        Supported Boards and Build Instructions
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/RelayKeys/assets/js/app.4e4d4d42.js" defer></script><script src="/RelayKeys/assets/js/2.6ef3ed40.js" defer></script><script src="/RelayKeys/assets/js/7.783ad4b0.js" defer></script>
  </body>
</html>
